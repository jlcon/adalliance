<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wy.adalliance.dal.thinksns.maps.TsFeedDataMapper">
  <resultMap id="BaseResultMap" type="com.wy.adalliance.dal.thinksns.model.TsFeedData">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 21 10:43:12 CST 2016.
    -->
    <id column="feed_id" jdbcType="INTEGER" property="feedId" />
    <result column="client_ip" jdbcType="CHAR" property="clientIp" />
    <result column="client_port" jdbcType="CHAR" property="clientPort" />
  </resultMap>
  <resultMap extends="BaseResultMap" id="ResultMapWithBLOBs" type="com.wy.adalliance.dal.thinksns.model.TsFeedDataWithBLOBs">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 21 10:43:12 CST 2016.
    -->
    <result column="feed_data" jdbcType="LONGVARCHAR" property="feedData" />
    <result column="feed_content" jdbcType="LONGVARCHAR" property="feedContent" />
    <result column="from_data" jdbcType="LONGVARCHAR" property="fromData" />
  </resultMap>
  <sql id="Example_Where_Clause">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 21 10:43:12 CST 2016.
    -->
    <where>
      <foreach collection="oredCriteria" item="criteria" separator="or">
        <if test="criteria.valid">
          <trim prefix="(" prefixOverrides="and" suffix=")">
            <foreach collection="criteria.criteria" item="criterion">
              <choose>
                <when test="criterion.noValue">
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue">
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue">
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue">
                  and ${criterion.condition}
                  <foreach close=")" collection="criterion.value" item="listItem" open="(" separator=",">
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Update_By_Example_Where_Clause">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 21 10:43:12 CST 2016.
    -->
    <where>
      <foreach collection="example.oredCriteria" item="criteria" separator="or">
        <if test="criteria.valid">
          <trim prefix="(" prefixOverrides="and" suffix=")">
            <foreach collection="criteria.criteria" item="criterion">
              <choose>
                <when test="criterion.noValue">
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue">
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue">
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue">
                  and ${criterion.condition}
                  <foreach close=")" collection="criterion.value" item="listItem" open="(" separator=",">
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 21 10:43:12 CST 2016.
    -->
    feed_id, client_ip, client_port
  </sql>
  <sql id="Blob_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 21 10:43:12 CST 2016.
    -->
    feed_data, feed_content, from_data
  </sql>
  <select id="selectByExampleWithBLOBs" parameterType="com.wy.adalliance.dal.thinksns.model.TsFeedDataExample" resultMap="ResultMapWithBLOBs">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 21 10:43:12 CST 2016.
    -->
    select
    <if test="distinct">
      distinct
    </if>
    <include refid="Base_Column_List" />
    ,
    <include refid="Blob_Column_List" />
    from ts_feed_data
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null">
      order by ${orderByClause}
    </if>
  </select>
  <select id="selectByExample" parameterType="com.wy.adalliance.dal.thinksns.model.TsFeedDataExample" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 21 10:43:12 CST 2016.
    -->
    select
    <if test="distinct">
      distinct
    </if>
    <include refid="Base_Column_List" />
    from ts_feed_data
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null">
      order by ${orderByClause}
    </if>
  </select>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="ResultMapWithBLOBs">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 21 10:43:12 CST 2016.
    -->
    select 
    <include refid="Base_Column_List" />
    ,
    <include refid="Blob_Column_List" />
    from ts_feed_data
    where feed_id = #{feedId,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 21 10:43:12 CST 2016.
    -->
    delete from ts_feed_data
    where feed_id = #{feedId,jdbcType=INTEGER}
  </delete>
  <delete id="deleteByExample" parameterType="com.wy.adalliance.dal.thinksns.model.TsFeedDataExample">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 21 10:43:12 CST 2016.
    -->
    delete from ts_feed_data
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
  </delete>
  <insert id="insert" parameterType="com.wy.adalliance.dal.thinksns.model.TsFeedDataWithBLOBs">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 21 10:43:12 CST 2016.
    -->
    <selectKey keyProperty="feedId" order="AFTER" resultType="java.lang.Integer">
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into ts_feed_data (client_ip, client_port, feed_data, 
      feed_content, from_data)
    values (#{clientIp,jdbcType=CHAR}, #{clientPort,jdbcType=CHAR}, #{feedData,jdbcType=LONGVARCHAR}, 
      #{feedContent,jdbcType=LONGVARCHAR}, #{fromData,jdbcType=LONGVARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.wy.adalliance.dal.thinksns.model.TsFeedDataWithBLOBs">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 21 10:43:12 CST 2016.
    -->
    <selectKey keyProperty="feedId" order="AFTER" resultType="java.lang.Integer">
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into ts_feed_data
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="clientIp != null">
        client_ip,
      </if>
      <if test="clientPort != null">
        client_port,
      </if>
      <if test="feedData != null">
        feed_data,
      </if>
      <if test="feedContent != null">
        feed_content,
      </if>
      <if test="fromData != null">
        from_data,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="clientIp != null">
        #{clientIp,jdbcType=CHAR},
      </if>
      <if test="clientPort != null">
        #{clientPort,jdbcType=CHAR},
      </if>
      <if test="feedData != null">
        #{feedData,jdbcType=LONGVARCHAR},
      </if>
      <if test="feedContent != null">
        #{feedContent,jdbcType=LONGVARCHAR},
      </if>
      <if test="fromData != null">
        #{fromData,jdbcType=LONGVARCHAR},
      </if>
    </trim>
  </insert>
  <select id="countByExample" parameterType="com.wy.adalliance.dal.thinksns.model.TsFeedDataExample" resultType="java.lang.Integer">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 21 10:43:12 CST 2016.
    -->
    select count(*) from ts_feed_data
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
  </select>
  <update id="updateByExampleSelective" parameterType="map">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 21 10:43:12 CST 2016.
    -->
    update ts_feed_data
    <set>
      <if test="record.feedId != null">
        feed_id = #{record.feedId,jdbcType=INTEGER},
      </if>
      <if test="record.clientIp != null">
        client_ip = #{record.clientIp,jdbcType=CHAR},
      </if>
      <if test="record.clientPort != null">
        client_port = #{record.clientPort,jdbcType=CHAR},
      </if>
      <if test="record.feedData != null">
        feed_data = #{record.feedData,jdbcType=LONGVARCHAR},
      </if>
      <if test="record.feedContent != null">
        feed_content = #{record.feedContent,jdbcType=LONGVARCHAR},
      </if>
      <if test="record.fromData != null">
        from_data = #{record.fromData,jdbcType=LONGVARCHAR},
      </if>
    </set>
    <if test="_parameter != null">
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByExampleWithBLOBs" parameterType="map">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 21 10:43:12 CST 2016.
    -->
    update ts_feed_data
    set feed_id = #{record.feedId,jdbcType=INTEGER},
      client_ip = #{record.clientIp,jdbcType=CHAR},
      client_port = #{record.clientPort,jdbcType=CHAR},
      feed_data = #{record.feedData,jdbcType=LONGVARCHAR},
      feed_content = #{record.feedContent,jdbcType=LONGVARCHAR},
      from_data = #{record.fromData,jdbcType=LONGVARCHAR}
    <if test="_parameter != null">
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByExample" parameterType="map">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 21 10:43:12 CST 2016.
    -->
    update ts_feed_data
    set feed_id = #{record.feedId,jdbcType=INTEGER},
      client_ip = #{record.clientIp,jdbcType=CHAR},
      client_port = #{record.clientPort,jdbcType=CHAR}
    <if test="_parameter != null">
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByPrimaryKeySelective" parameterType="com.wy.adalliance.dal.thinksns.model.TsFeedDataWithBLOBs">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 21 10:43:12 CST 2016.
    -->
    update ts_feed_data
    <set>
      <if test="clientIp != null">
        client_ip = #{clientIp,jdbcType=CHAR},
      </if>
      <if test="clientPort != null">
        client_port = #{clientPort,jdbcType=CHAR},
      </if>
      <if test="feedData != null">
        feed_data = #{feedData,jdbcType=LONGVARCHAR},
      </if>
      <if test="feedContent != null">
        feed_content = #{feedContent,jdbcType=LONGVARCHAR},
      </if>
      <if test="fromData != null">
        from_data = #{fromData,jdbcType=LONGVARCHAR},
      </if>
    </set>
    where feed_id = #{feedId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKeyWithBLOBs" parameterType="com.wy.adalliance.dal.thinksns.model.TsFeedDataWithBLOBs">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 21 10:43:12 CST 2016.
    -->
    update ts_feed_data
    set client_ip = #{clientIp,jdbcType=CHAR},
      client_port = #{clientPort,jdbcType=CHAR},
      feed_data = #{feedData,jdbcType=LONGVARCHAR},
      feed_content = #{feedContent,jdbcType=LONGVARCHAR},
      from_data = #{fromData,jdbcType=LONGVARCHAR}
    where feed_id = #{feedId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.wy.adalliance.dal.thinksns.model.TsFeedData">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 21 10:43:12 CST 2016.
    -->
    update ts_feed_data
    set client_ip = #{clientIp,jdbcType=CHAR},
      client_port = #{clientPort,jdbcType=CHAR}
    where feed_id = #{feedId,jdbcType=INTEGER}
  </update>
  <select id="selectByExampleWithBLOBsWithRowbounds" parameterType="com.wy.adalliance.dal.thinksns.model.TsFeedDataExample" resultMap="ResultMapWithBLOBs">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 21 10:43:12 CST 2016.
    -->
    select
    <if test="distinct">
      distinct
    </if>
    <include refid="Base_Column_List" />
    ,
    <include refid="Blob_Column_List" />
    from ts_feed_data
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null">
      order by ${orderByClause}
    </if>
  </select>
  <select id="selectByExampleWithRowbounds" parameterType="com.wy.adalliance.dal.thinksns.model.TsFeedDataExample" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 21 10:43:12 CST 2016.
    -->
    select
    <if test="distinct">
      distinct
    </if>
    <include refid="Base_Column_List" />
    from ts_feed_data
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null">
      order by ${orderByClause}
    </if>
  </select>
  <select id="queryWeiboByDate" resultType="hashmap" parameterType="hashmap">
  <![CDATA[
    SELECT
		ts_user.uname 'name',ts_user.email 'email',ts_user.phone 'phone',temp1.feed_content 'work',temp1.user_group_name 'groupname',temp1.fbsj 'writetime',
		WEEKDAY(temp1.fbsj) 'weekdays'
	FROM
		ts_user
	LEFT JOIN
	(SELECT
		ts_user.uname,
		ts_user.phone,
		ts_user.email,
		ts_user.uid,
		ts_feed_data.feed_content,
		ts_user_group.user_group_name,
		from_unixtime(ts_feed.publish_time,'%Y-%m-%d %H:%i:%s') as fbsj
	FROM
		ts_user
	LEFT JOIN ts_feed ON ts_feed.uid = ts_user.uid
	LEFT JOIN ts_feed_data ON ts_feed.feed_id = ts_feed_data.feed_id
	LEFT JOIN ts_user_group_link ON ts_user.uid = ts_user_group_link.uid
	LEFT JOIN ts_user_group ON ts_user_group_link.user_group_id = ts_user_group.user_group_id
	WHERE
		from_unixtime(ts_feed.publish_time,'%Y-%m-%d') >= #{timeStart,jdbcType=VARCHAR}
	AND
		from_unixtime(ts_feed.publish_time,'%Y-%m-%d') <= #{timeEnd,jdbcType=VARCHAR}) as temp1
	ON ts_user.uid = temp1.uid
	]]>
	<where>
		<choose>
		    <when test="selectedNames != null and selectedNames.size() > 0">
		        <foreach collection="selectedNames" separator="or" open="(" close=")" item="selectedName">
				<![CDATA[
					ts_user.email = '${selectedName}'
				]]>    
				</foreach>
		    </when>
			<when test="theName!=null and theName!=''">
			<![CDATA[
				ts_user.uname LIKE '%${theName}%'
			]]>
			</when>
			<otherwise>
			<![CDATA[
				ts_user.email IN
				('monkey@unknowntech.cn','josh@unknowntech.cn','zero@unknowntech.cn','ernest@unknowntech.cn','felix@unknowntech.cn',
				'caspar@unknowntech.cn','kim@unknowntech.cn','warden@unknowntech.cn','sam@unknowntech.cn',
				'zack@unknowntech.cn','conan@unknowntech.cn','rocky@unknowntech.cn','jetty@unknowntech.cn','berry@unknowntech.cn','darius@unknowntech.cn',
				'maybach@unknowntech.cn','Darius@unknowntech.com','shaw@unknowntech.cn','valentin@unknowntech.cn‍','finghin@unknowntech.cn‍',
				'tiger@unknowntech.cn','berry@unknowntech.com','mingle@unknowntech.cn','finghin@unknowntech.cn',
				'sirona@unknowntech.cn','mandy@unknowntech.cn','eline@unknowntech.cn','sherly@unknowntech.cn','clover@unknowntech.cn')
			]]>
			</otherwise>
		</choose>
		<if test="check !=null and check != '' and check == 'true'.toString()">
		    <![CDATA[
		    	AND temp1.feed_content IS NULL
		    ]]>
		</if>
		<![CDATA[
			ORDER BY temp1.fbsj
		]]>
	</where>
  </select>
</mapper>